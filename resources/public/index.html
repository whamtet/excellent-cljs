<!--
Copyright (c) 2012, 2013 Fogus and Relevance Inc. All rights reserved.  The
use and distribution terms for this software are covered by the Eclipse
Public License 1.0 (http://opensource.org/licenses/eclipse-1.0.php)
which can be found in the file COPYING the root of this
distribution.  By using this software in any fashion, you are
agreeing to be bound by the terms of this license.  You must not
remove this notice, or any other, from this software.
-->

<html>
<head>
  <script type="text/javascript" src="vendor/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="vendor/jquery.console.js"></script>
  <script type="text/javascript" src="js/repl.js"></script>
  <script type="text/javascript">
    goog.require('himera.client.repl')
  </script>
  <link rel="stylesheet" type="text/css" href="stylesheets/base.css" />
  <link rel="stylesheet" type="text/css" href="stylesheets/layout.css" />
  <link rel="stylesheet" type="text/css" href="stylesheets/skeleton.css" />
  <link rel="stylesheet" type="text/css" href="stylesheets/himera.css" />
  <title>Excellent</title>
</head>
<body>

  <div class="container">

    <h1 id="title">Excellent</h1>

    <h2>Clojurescript targeting Excel</h2>

    <div class="console" id="console"></div>
      <br />
      <form action="/" method="post" id="loadform" enctype="multipart/form-data">
        <input type="file" name="file" id="file" value="Select Source File">
        <input type="submit" value="Load">
      </form>
      <textarea id="workspace" style="%s" rows="40">%s</textarea>
      </div>
    <form action="/save.clj" method="post" id="saveform" enctype="multipart/form-data">
        <input type="hidden" name="savetext" id="savetext">
        </input>
    </form>
    <form action="/spreadsheet.xls" method="post" id="spreadsheetform" enctype="multipart/form-data">
        <input type="hidden" name="toappend" id="toappend">
        </input>
    </form>

    <script>
        save = function() {
            $('#savetext').val($('#workspace').val())
            $('#saveform').submit()
        }
        spreadsheet = function() {
            $('#toappend').val($('#workspace').val())
            $('#spreadsheetform').submit()
        }
    </script>
    <!--
    <div class="source">
      <p><a href="http://github.com/fogus/himera">View source on Github <img src="images/github-icon.png" /></a></p>
    </div>
-->
  </div>

<script>
  himera.client.repl.go()
  goog.require('cljs.core')
  goog.provide('cljs.user')
</script>

</body>
</html>
